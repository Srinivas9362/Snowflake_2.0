ğŸ¯ Snowflake Micro-Partition Visual Diagram
1ï¸âƒ£ How Snowflake Stores Tables Physically
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       SNOWFLAKE TABLE         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Table is automatically broken into           â”‚
â”‚ 16 MB MICRO-PARTITIONS                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

2ï¸âƒ£ Micro-Partition Layout (Example)
                Snowflake Storage Layer
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MICRO-PARTITIONS (Immutable, 16MB each)                    â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ MP1        â”‚ â”‚ MP2          â”‚ â”‚ MP3          â”‚ ...       â”‚
â”‚  â”‚------------â”‚ â”‚--------------â”‚ â”‚--------------â”‚           â”‚
â”‚  â”‚ DATE: 1-10 â”‚ â”‚ DATE: 11-20  â”‚ â”‚ DATE: 21-30  â”‚           â”‚
â”‚  â”‚ Region A   â”‚ â”‚ Region A/B   â”‚ â”‚ Region B     â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


Each micro-partition contains:

Columnar data

Min/max values for each column

Metadata

Zone map statistics

Compression metadata

This metadata is key to pruning.

ğŸ§  3ï¸âƒ£ How Pruning Works (Visually)

Suppose your table is clustered by DATE.

Your query:

SELECT * 
FROM SALES 
WHERE DATE = '2024-10-25';

âŒ Without Clustering (Bad / Random Inserts)
Snowflake must scan ALL micro-partitions

â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”
â”‚ MP1  â”‚ MP2  â”‚ MP3  â”‚ MP4  â”‚ MP5  â”‚ MP6  â”‚ MP7  â”‚  â†’ 7 MPs scanned
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜

âœ” With Clustering (Good)
Snowflake prunes the MPs that donâ€™t contain matching dates
Only 1 MP scanned

â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”
â”‚ MP1  â”‚ MP2  â”‚ **MP3 âœ”** â”‚ MP4  â”‚ MP5  â”‚ MP6  â”‚ MP7  â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜


This is clustering efficiency â†’ fewer partitions scanned.

ğŸ” 4ï¸âƒ£ Micro-Partition Overlap (Why Clustering Fails)

Overlap happens when micro-partitions contain mixed ranges.

âŒ Overlap Example (Bad)
Micro-partitions contain overlapping date ranges:

MP1: 1â€“15  
MP2: 10â€“25  
MP3: 20â€“30  


Query:

WHERE DATE = 12


Snowflake must scan MP1 AND MP2 AND MP3 â†’ bad pruning.

âœ” Good Example (Non-overlap)
MP1: 1â€“10  
MP2: 11â€“20  
MP3: 21â€“30  


Query for DATE=12 scans only MP2 â†’ excellent pruning.

ğŸ§© 5ï¸âƒ£ Clustering Key Effect (Visual)
Before Clustering (Random Inserts â†’ Chaos)
MP1: Dates = 5,98,40
MP2: Dates = 10,60,13
MP3: Dates = 90,12,55
MP4: Dates = 70,20,30


Query:

WHERE DATE BETWEEN 10 AND 20


Snowflake must scan all 4 MPs â†’ expensive.

After Clustering (Organized Partitions)
MP1: 1â€“10
MP2: 11â€“20
MP3: 21â€“30
MP4: 31â€“40


Query:

WHERE DATE BETWEEN 10 AND 20


Snowflake scans only MP1 + MP2 â†’ cheap & fast.

ğŸ§¨ 6ï¸âƒ£ FULL MICRO-PARTITION DIAGRAM (Interview-Friendly)

Here is a complete visualization you can draw in interviews:

Snowflake Table
        |
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Automatic Micro-Partitioning       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        |
        â–¼

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MP1       â”‚  MP2       â”‚  MP3       â”‚  MP4       â”‚  MP5       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Date 1â€“10  â”‚ Date 11â€“20 â”‚ Date 21â€“30 â”‚ Date 31â€“40 â”‚ Date 41â€“50 â”‚
â”‚ Region A   â”‚ Region A/B â”‚ Region B   â”‚ Region B   â”‚ Region C   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Query: WHERE DATE = 27
â†’ Only MP3 scanned
â†’ Low bytes scanned
â†’ High pruning efficiency

ğŸ† 7ï¸âƒ£ EXACT Interview Answer (Use this)

â€œSnowflake stores table data in immutable 16MB micro-partitions with metadata like min/max values.
If partitions have no overlap on the filtering column, Snowflake prunes most partitions â€” scanning only the relevant ones.
High overlap means Snowflake must scan many partitions, which increases bytes scanned and decreases performance.
Clustering improves pruning by organizing micro-partitions into ordered ranges with minimal overlap.â€


---
âœ… 2. Query Profile â€“ What You Must Check
Look at these fields in the profile:
Metric	Meaning	Good	Bad
Partitions scanned	Micro-partitions Snowflake had to touch	Low	High
Bytes scanned	Data actually read	Small	Huge
Scan progress	How much of table scanned	<20%	~100%
Remote I/O	Reads from disk (slow)	Low	High
Local cache hit	Read from cache	High	Low
âœ… 3. SYSTEM$CLUSTERING_INFORMATION Metrics
Field	Meaning	Good	Bad
average_overlaps	MP overlap	0â€“0.20	>0.50
average_depth	MP fragmentation	<3	>5
total_partition_count	# of MP	Depends	Only for analysis
constant partition count	zero-range MPs	0	>20 (bad)
ğŸ¯ What â€œPoor Clusteringâ€ Looks Like (Interview Example)

Bad example:

Partitions scanned: 4250 / 4300
Bytes scanned: 350GB
Scan progress: 97%
Cache usage: 12%
average_overlaps: 1.8
average_depth: 9


Interpretation:

Almost every micro-partition scanned â†’ terrible pruning

High overlap â†’ meaningless clustering

High depth â†’ fragmented

Cache % low â†’ expensive

ğŸ¯ What â€œGreat Clusteringâ€ Looks Like (Interview Example)

Good example:

Partitions scanned: 180 / 4300
Bytes scanned: 11GB
Scan progress: 7%
Cache usage: 99%
average_overlaps: 0.12
average_depth: 2


Interpretation:

Pruning 96% of the table

Very low data scanning

Cache returning most data

Clustering healthy

ğŸ† EXACT INTERVIEW ANSWER (Use this)

â€œGood pruning means Snowflake only scans the micro-partitions that contain relevant data.
We measure this through metrics like low partitions scanned, low bytes scanned, low scan progress, and high cache usage.
Poor pruning shows the opposite and usually happens due to high micro-partition overlap or poor clustering.â€

âœ… 4. Pruning Performance Formula (Easy to Remember)
Effective Pruning = 
( Low partitions scanned + 
  Low bytes scanned + 
  High cache % ) 
Ã· High total table size


This is what interviewers expect.